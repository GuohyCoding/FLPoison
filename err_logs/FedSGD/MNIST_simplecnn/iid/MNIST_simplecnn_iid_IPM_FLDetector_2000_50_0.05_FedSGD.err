Warning: Overriding benchmark with False
Warning: Overriding epochs with 2000
Warning: Overriding algorithm with FedSGD
Warning: Overriding learning_rate with 0.05
Warning: Overriding model with simplecnn
Warning: Overriding dataset with MNIST
Warning: Overriding distribution with iid
Warning: Overriding gpu_idx with [1]
Using device: cuda:1
/home/hongyi/FLPoison/aggregators/fldetector.py:186: RuntimeWarning: overflow encountered in matmul
  S_k_time_S_k = np.matmul(curr_S_k.T, curr_S_k)
/home/hongyi/FLPoison/aggregators/fldetector.py:191: RuntimeWarning: overflow encountered in matmul
  (np.matmul(S_k_list[-1].T, S_k_list[-1]))
/home/hongyi/FLPoison/aggregators/fldetector.py:193: RuntimeWarning: invalid value encountered in multiply
  upper_mat = np.concatenate([sigma_k * S_k_time_S_k, L_k], axis=1)
Traceback (most recent call last):
  File "/home/hongyi/FLPoison/main.py", line 310, in <module>
    main(args, cli_args)
  File "/home/hongyi/FLPoison/main.py", line 305, in main
    fl_run(args)
  File "/home/hongyi/FLPoison/main.py", line 116, in fl_run
    the_server.aggregation()  # run the configured robust mean/aggregator
  File "/home/hongyi/FLPoison/fl/server.py", line 211, in aggregation
    self.aggregated_update = self.aggregator.aggregate(
  File "/home/hongyi/FLPoison/aggregators/fldetector.py", line 99, in aggregate
    hvp = self.LBFGS(self.global_weight_diffs, self.global_grad_diffs,
  File "/home/hongyi/FLPoison/aggregators/fldetector.py", line 196, in LBFGS
    mat_inv = np.linalg.inv(mat)
  File "/home/hongyi/lib/ENTER/envs/FLPoison/lib/python3.10/site-packages/numpy/linalg/linalg.py", line 561, in inv
    ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
  File "/home/hongyi/lib/ENTER/envs/FLPoison/lib/python3.10/site-packages/numpy/linalg/linalg.py", line 112, in _raise_linalgerror_singular
    raise LinAlgError("Singular matrix")
numpy.linalg.LinAlgError: Singular matrix
